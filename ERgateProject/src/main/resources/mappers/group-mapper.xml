<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="groupMapper">

	<resultMap id="employeeResultSet" type="Employee">
		<id column="EMP_ID" property="empId"/>
		<result column="RANK_CODE" property="rankCode"/>
		<result column="DEPT_CODE" property="deptCode"/>
		<result column="JOB_CODE" property="jobCode"/>
		<result column="EMP_CODE" property="empCode"/>
		<result column="EMP_PWD" property="empPwd"/>
		<result column="EMP_NAME" property="empName"/>
		<result column="HIRE_DATE" property="hireDate"/>
		<result column="EMP_EXTENSION" property="empExtension"/>
		<result column="EMP_FAX" property="empFax"/>
		<result column="EMP_COM_EMAIL" property="empComEmail"/>
		<result column="EMP_PRI_EMAIL" property="empPriEmail"/>
		<result column="EMP_PHONE" property="empPhone"/>
		<result column="EMP_ADDRESS" property="empAddress"/>
		<result column="EMP_IMAGE" property="empImage"/>
		<result column="EMP_BIRTHDAY" property="empBirthday"/>
		<result column="RESIGN_FLAG" property="resignFlag"/>
		<result column="RESIGN_DATE" property="resignDate"/>
		<result column="EMP_STATUS" property="empStatus"/>
		<result column="RANK_TITLE" property="rankTitle"/>
		<result column="DEPT_TITLE" property="deptTitle"/>
		<result column="JOB_TITLE" property="jobTitle"/>
	</resultMap>
	
	
	<!-- 조직도 전제 사원 조회 -->
	<select id="selectEmpList" resultMap="employeeResultSet">
		select emp_name, rank_title, job_title, emp_id
		  from employee e	
		  join rank r on e.rank_code=r.rank_code
		  join job j on e.job_code=j.job_code
		 where resign_flag='N'
	</select>
	
	<!-- 조직도 부서별 사원 조회 -->
	<select id="selectDeptEmpList" parameterType="string" resultMap="employeeResultSet">
		select emp_name, rank_title, job_title, emp_id
		  from employee e	
		  join rank r on e.rank_code=r.rank_code
		  join job j on e.job_code=j.job_code
		 where resign_flag='N'
	 	<choose>
	 		<when test="keyword.equals('D0')">
	 			and dept_code='D0'
	 		</when>
	 		<when test="keyword.equals('D1')">
	 			and dept_code='D1'
	 		</when>
	 		<when test="keyword.equals('D2')">
	 			and dept_code='D2'
	 		</when>
	 		<when test="keyword.equals('D3')">
	 			and dept_code='D3'
	 		</when>
	 		<when test="keyword.equals('D4')">
	 			and dept_code='D4'
	 		</when>
	 		<when test="keyword.equals('D4')">
	 			and dept_code='D5'
	 		</when>
	 	</choose>
	</select>
	
	<!-- 조직도 사원 프로필 조회 (오른쪽 영역) -->
	<select id="selectEmpProfile" parameterType="string" resultMap="employeeResultSet">
		select emp_name, emp_code, hire_date, emp_id, emp_birthday, emp_phone, emp_extension, emp_fax, dept_title, rank_title, job_title, emp_address, emp_image, emp_com_email
		  from employee e
		  join rank r on e.rank_code=r.rank_code
		  join job j on e.job_code=j.job_code
		  join department d on e.dept_code=d.dept_code
		 where emp_id=#{empId} and resign_flag='N'
		
	</select>
</mapper>
